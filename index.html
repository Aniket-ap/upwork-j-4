<html>

<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/somethinggoodone/cdn/AniketPradhan_bootstrap.css" />
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
	<style>
	input,
	select,
	textarea {
		text-overflow: ellipsis;
	}

	button:focus,
	button:active {
		outline-color: #c6a5ff;
	}

	label {
		font-weight: 500 !important;
		color: #374151 !important;
	}

	.bg-theme {
		background: rgba(103, 58, 183, .07) !important;
	}

	.text-theme {
		color: #673ab7;
	}

	.form-control.custom-width {
		min-width: 75px;
	}
	</style>
</head>

<body>
	<button type="button" class="m-3 btn btn-primary" id="pdfprint">New PDF File</button>
	<button type="button" class="m-3 btn btn-outline-secondary" id="restoreall">Restore All</button>
	<button type="button" class="m-3 btn btn-outline-secondary" id="sendall">Send All</button>
	<hr>
	<ul class="list-group" id="tasks-point-l9zgqjql"></ul>
	<div id="modal"></div>
	<script>
	function atoo(f, b) {
		var c = [],
			d = !1;
		f.forEach(function(g, e) {
			var a = {};
			a.key = g;
			a.value = 0 === b[e].length ? "" : b[e];
			"" === a.key.trim() && "" !== a.value ? d = !0 : "" !== a.key.trim() && c.push(a);
		});
		return d ? !1 : c;
	}

	function getAddTaskEnvelope(wid, tid, tasktype, task_body) {
		return `<li class="border-top-0 border-end-0 border-start-0 list-group-item tsk-${wid}-${tid} ${tasktype}" data-id="${wid}-${tid}" data-type="${tasktype}">
			<img src="https://img.icons8.com/color/48/null/pdf.png" class="float-start" />
			<div class="btn-group float-end">
				<button type="button" class="btn dropdown-toggle btn-light" data-bs-toggle="dropdown" aria-expanded="false"> Actions </button>
				<ul class="dropdown-menu dropdown-menu-lg-end">
					<li><a data-bs-toggle="modal" href="#task-modal-${wid}-${tid}" role="button" class="dropdown-item" href="#">Edit</a></li>
					<li><a class="dropdown-item" href="#">Duplicate</a></li>
					<li><a class="dropdown-item tdelete" href="#">Delete</a></li>
				</ul>
			</div>
			${task_body}
		</li>`
	}

	function getPDFFileValues(wid, tid) {
		let result = {};
		result.taskType = "pdfprint";
		result.id = tid;
		result.name = `${wid}-${tid}`;
		// Page setup
		function pageSetupTabRedirect() {
			$(`[data-bs-target="#nav-page-setup-${wid}-${tid}"]`).trigger('click');
		}
		// Print
		let printValue = $(`#print-${wid}-${tid}`).val();
		let printTextValue = $(`#print-${wid}-${tid} option:selected`).text();
		if (printTextValue.indexOf("Selected range of ") == 0) {
			let rangeVal = $(`#print-range-${wid}-${tid}`).val();
			if (rangeVal.trim().length === 0) {
				pageSetupTabRedirect();
				alert("Range should not be empty in Page setup tab");
				return;
			} else {
				result.print = {
					"type": "custom",
					"value": [{
						"sheet": `${printValue}`,
						"range": `${rangeVal}`
					}]
				}
			}
		} else if (printValue === "workbook") {
			let webworkVal = $(`.selection-${wid}-${tid} > input`).val();
			if (webworkVal === "All Sheets") {
				result.print = {
					"type": "workbook"
				}
			} else {
				let arr = [];
				$(`.selection-${wid}-${tid} :checkbox:checked`).each(function() {
					arr.push({
						"sheet": $(this).val()
					});
				});
				result.print = {
					"type": "workbook",
					"value": arr
				}
			}
		} else {
			result.print = {
				"type": "custom",
				"value": [{
					"sheet": `${printValue}`
				}]
			}
		}
		// Paper Size
		let paperSizeVal = $(`#size-${wid}-${tid}`).val();
		let height;
		let width;
		if (paperSizeVal == "custom") {
			height = $(`#size-height-${wid}-${tid}`).val();
			width = $(`#size-width-${wid}-${tid}`).val();
			if (height.trim().length === 0 || width.trim().length === 0) {
				pageSetupTabRedirect();
				alert("Height and Width should not be empty in Page setup tab");
				return;
			}
			if (width < 2.5) {
				pageSetupTabRedirect()
				alert(`Please enter Page Width value greater than 2.5" in Paper size`);
				return;
			}
			if (height < 2.5) {
				pageSetupTabRedirect()
				alert(`Please enter Page Height value greater than 2.5" in Paper size`);
				return;
			}
			if (height > 60 || width > 60) {
				pageSetupTabRedirect()
				alert(`Please enter a number no greater than 60" in Paper size`);
				return;
			}
			result.size = {
				"type": "custom",
				"value": {
					"height": `${height}`,
					"width": `${width}`,
				}
			}
		} else {
			width = $(`#size-${wid}-${tid}`).find(':selected').attr('data-width');
			height = $(`#size-${wid}-${tid}`).find(':selected').attr('data-height');
			result.size = {
				"type": `${paperSizeVal}`
			}
		}
		// Scale
		let scaleVal = $(`#scale-${wid}-${tid}`).val();
		if (scaleVal == "custom") {
			let percentageVal = Math.round($(`#percentage-${wid}-${tid}`).val());
			if (Number(percentageVal) < 1 || percentageVal.length === 0) {
				pageSetupTabRedirect();
				alert("Please enter a positive Percentage value ");
				return;
			}
			result.scale = {
				"type": "custom",
				"value": {
					"percentage": `${percentageVal/100}`,
				}
			}
		} else if (scaleVal == "fit_pagebreak") {
			let row = $(`#break-row-${wid}-${tid}`).val();
			let col = $(`#break-column-${wid}-${tid}`).val();
			if (col > 18278) {
				pageSetupTabRedirect();
				alert("Please enter a value less then 18278");
				return;
			}
			result.scale = {
				"type": "fit_pagebreak",
				"value": {
					"row": Number(`${row}`),
					"column": Number(`${col}`)
				}
			}
		} else {
			result.scale = {
				"type": `${scaleVal}`
			}
		}
		// Margins
		let marginsVal = $(`#margins-${wid}-${tid}`).val();
		if (marginsVal == "custom") {
			let top = $(`#margins-top-${wid}-${tid}`).val();
			let left = $(`#margins-left-${wid}-${tid}`).val();
			let right = $(`#margins-right-${wid}-${tid}`).val();
			let bottom = $(`#margins-bottom-${wid}-${tid}`).val();
			if (top.trim().length === 0 || left.trim().length === 0 || right.trim().length === 0 || bottom.trim().length === 0) {
				pageSetupTabRedirect();
				alert("Margins Top, Left, Right and Bottom value should not be empty in Page setup tab");
				return;
			}
			if (top > (height - 1) || bottom > (height - 1)) {
				alert(`The maximum value of the Top/Bottom Margin for the specified paper size is ${height - 1}`)
				return;
			}
			if (left > (width - 1) || right > (width - 1)) {
				alert(`The maximum value of the Left/Right Margin for the specified paper size is ${width - 1}`)
				return;
			}
			let maxTopValue = (height - 1) - bottom;
			let maxBottomValue = (height - 1) - top;
			let maxLeftValue = (width - 1) - right;
			let maxRightValue = (width - 1) - left;
			if (top >= bottom && (top < 0 || top > maxTopValue)) {
				pageSetupTabRedirect();
				alert(`Enter the Top margin number between 0 and ${maxTopValue}`);
				return;
			}
			if (left >= right && (left < 0 || left > maxLeftValue)) {
				pageSetupTabRedirect();
				alert(`Enter the Left margin number between 0 and ${maxLeftValue}`);
				return;
			}
			if (right >= left && (right < 0 || right > maxRightValue)) {
				pageSetupTabRedirect();
				alert(`Enter the Right margin number between 0 and ${maxRightValue}`);
				return;
			}
			if (bottom >= top && (bottom < 0 || bottom > maxBottomValue)) {
				pageSetupTabRedirect();
				alert(`Enter the Bottom margin number between 0 and ${maxBottomValue}`);
				return;
			}
			result.margins = {
				"type": "custom",
				"value": {
					"top": Number(`${top}`),
					"left": Number(`${left}`),
					"right": Number(`${right}`),
					"bottom": Number(`${bottom}`),
				}
			}
		} else {
			result.margins = {
				"type": `${marginsVal}`
			}
		}
		// Page Orietation
		let selectedRadioValue = $("input[name='pageSetupRadio']:checked").val();
		result.orientation = {
			"type": `${selectedRadioValue}`
		}
		// Format tab
		// gridlines
		result.gridlines = {
			"value": $(`#showgridlines-${wid}-${tid}`).is(":checked")
		}
		// notes
		result.notes = {
			"value": $(`#shownotes-${wid}-${tid}`).is(":checked")
		}
		// Pageorder
		let pageOrderVal = $(`#pageorder-${wid}-${tid}`).val();
		result.pageorder = {
			"value": `${pageOrderVal}`
		}
		// Alignment
		result.h_alignment = {
			"value": $(`#horizontal-alignment-${wid}-${tid}`).val()
		}
		result.v_alignment = {
			"value": $(`#vertical-alignment-${wid}-${tid}`).val()
		}
		// Headers & Footer
		result.hf = {
			"options": {
				"hf_fzr": $(`#frozen-rows-${wid}-${tid}`).is(":checked"),
				"hf_fzc": $(`#frozen-columns-${wid}-${tid}`).is(":checked")
			},
			"type": "custom",
			"value": {
				"top_left": $(`#top-left-${wid}-${tid}`).val(),
				"top_center": $(`#top-middle-${wid}-${tid}`).val(),
				"top_right": $(`#top-right-${wid}-${tid}`).val(),
				"bottom_left": $(`#bottom-left-${wid}-${tid}`).val(),
				"bottom_center": $(`#bottom-middle-${wid}-${tid}`).val(),
				"bottom_right": $(`#bottom-right-${wid}-${tid}`).val(),
			}
		}
		return result;
	}
	// Dynamic columnName
	function toColumnName(d) {
		for (var a = "", b = 1, c = 26; 0 <= (d -= b); b = c, c *= 26) a = String.fromCharCode(parseInt(d % c / b) + 65) + a;
		return a
	};

	function createTask_PDFFile(wid, task) {
		var tid = task?.id ? task.id : Math.random().toString(36).substr(2, 8);
		var html_task = getAddTaskEnvelope(wid, tid, "pdfprint", `<div class="ms-5 ps-3">
	<span class="task-title">PDF File: ${wid}-${tid} </span><br>
	<span class="text-secondary small">Last updated </span><span class="time text-secondary small" data-time="1667889127596">15 days ago</span>
</div>
<div class="modal fade" id="task-modal-${wid}-${tid}" aria-hidden="true" aria-labelledby="task-modal-label-${wid}-${tid}" tabindex="-1">
	<div class="modal-dialog modal-fullscreen">
		<div class="modal-content">
			<div class="modal-header border border-bottom-0 bg-theme">
				<img style="width:25px;" src="https://img.icons8.com/color/48/null/pdf.png" class="float-start">&nbsp;
				<span class="modal-title fw-bolder ms-1 ps-0" id="task-modal-label-${wid}-${tid}">Create PDF File Instance</span>
				<button type="button" class="me-1 btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body border">
				<!--Modal body goes here.-->
				<div class="container mt-5">
					<div id="email-container-${wid}-${tid}" >
							<table border="0" width="100%" style="table-layout:fixed;">
								<tbody>
									<tr>
										<td colspan="2" class="p-3">
											<span class="pb-2 fw-bolder">Email Service</span><br>
											<span class="text-secondary">You may choose to send emails through Gmail,SparkPost,SendGrid or Amazon</span><br>
										</td>
									</tr>
									<tr>
										<td class="p-3">
											<label for="service-provider-${wid}-${tid}" class="form-label">Service Provider</label>
											<select class="form-select" id="service-provider-${wid}-${tid}">
												<option selected value="">Choose your email service provider...</option>
												<option value="gmail">Gmail</option>
												<option value="amazon">Amazon SES</option>
												<option value="sendgrid">SendGrid</option>
												<option value="sparkpost">SparkPost</option>
											</select>
										</td>
									</tr>
									<tr class="aws-row-${wid}-${tid}">
										<td class="p-3">
											<label for="aws-region-${wid}-${tid}" class="form-label">AWS Region</label>
											<select class="form-select" id="aws-region-${wid}{tid}">
												<option value="">Choose AWS Region...</option>
												<option value="us-east-2">US East (Ohio)</option>
												<option value="us-east-1">US East (N. Virginia)</option>
												<option value="us-west-1">US West (N. California)</option>
												<option value="us-west-2">US West (Oregon)</option>
												<option value="af-south-1">Africa (Cape Town)</option>
												<option value="ap-south-1">Asia Pacific (Mumbai)</option>
												<option value="ap-northeast-2">Asia Pacific (Seoul)</option>
												<option value="ap-southeast-1">Asia Pacific (Singapore)</option>
												<option value="ap-southeast-2">Asia Pacific (Sydney)</option>
												<option value="ap-northeast-1">Asia Pacific (Tokyo)</option>
												<option value="ca-central-1">Canada (Central)</option>
												<option value="eu-central-1">Europe (Frankfurt)</option>
												<option value="eu-west-1">Europe (Ireland)</option>
												<option value="eu-west-2">Europe (London)</option>
												<option value="eu-south-1">Europe (Milan)</option>
												<option value="eu-west-3">Europe (Paris)</option>
												<option value="eu-north-1">Europe (Stockholm)</option>
												<option value="me-south-1">Middle East (Bahrain)</option>
												<option value="sa-east-1">South America (SÃ£o Paulo)</option>
												<option value="us-gov-west-1">AWS GovCloud (US-West)</option>
											</select>
										</td>
										<td class="p-3">
											<label for="ses-key-${wid}-${tid}" class="form-label">SES Key id</label>
											<input type="text" class="form-control" id="ses-key-${wid}-${tid}" />
										</td>
										<td class="p-3">
											<label for="ses-secret-${wid}-${tid}" class="form-label">SES Secret</label>
											<input type="text" class="form-control" id="ses-secret-${wid}-${tid}" />
										</td>
									</tr>
									<tr class="sendgrid-row-${wid}-${tid}">
										<td class="p-3">
											<label for="sendgrid-api-${wid}-${tid}" class="form-label">SendGrid API Key</label>
											<input type="text" class="form-control" id="sendgrid-api-${wid}-${tid}" />
										</td>
									</tr>
									<tr class="sparkpost-row-${wid}-${tid}">
										<td class="p-3">
											<label for="sparkpost-api-${wid}-${tid}" class="form-label">SparkPost API Key</label>
											<input type="text" class="form-control" id="sparkpost-api-${wid}-${tid}" />
										</td>
									</tr>
									<tr class="gmail-row-${wid}-${tid}">
										<td colspan="2" class="p-3">
											<span class="pb-2 fw-bolder">The Sender</span><br>
											<span class="text-secondary">Specify the name and email alias that is shown as the sender in the email.</span><br>
										</td>
									</tr>
									<tr class="gmail-row-${wid}-${tid}">
										<td class="p-3">
											<label for="sender-name-${wid}-${tid}" class="form-label">Sender's Name</label>
											<input type="text" class="form-control" id="sender-name-${wid}-${tid}" />
										</td>
										<td class="p-3">
											<label for="sender-email-${wid}-${tid}" class="form-label">Sender's Email</label>
											<select class="form-select" id="sender-email-${wid}-${tid}">
												<option selected>somethinggooddone@gmail.com</option>
											</select>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-outline-secondary restore-${wid}-${tid}">Restore</button>
				<button type="submit" class="btn btn-primary done-${wid}-${tid}">Done</button>
			</div>
		</div>
	</div>
</div>`);
		$(`#tasks-point-${wid}`).append(html_task);
		if (!task) $(`#task-modal-${wid}-${tid}`).modal("show");

		// Hide all the row initially
		$(`.sparkpost-row-${wid}-${tid}, .sendgrid-row-${wid}-${tid}, .aws-row-${wid}-${tid}, .gmail-row-${wid}-${tid}`).hide();

		// TODO: For the future
		// <tr>
		// 	<td colspan="2">
		// 		<hr>
		// 	</td>
		// </tr>

		$(`#service-provider-${wid}-${tid}`).on("change", function() {
			var value = $(this).children('option:selected').val();
			if(value === "gmail"){
				$(`.gmail-row-${wid}-${tid}`).show();
				$(`.sparkpost-row-${wid}-${tid}, .sendgrid-row-${wid}-${tid}, .aws-row-${wid}-${tid}`).hide();
			} else if(value === "amazon"){
				$(`.aws-row-${wid}-${tid}`).show();
				$(`.sparkpost-row-${wid}-${tid}, .sendgrid-row-${wid}-${tid}, .gmail-row-${wid}-${tid}`).hide();
			} else if(value === "sendgrid"){
				$(`.sendgrid-row-${wid}-${tid}`).show();
				$(`.sparkpost-row-${wid}-${tid}, .aws-row-${wid}-${tid}, .gmail-row-${wid}-${tid}`).hide();
			} else if(value === "sparkpost"){
				$(`.sparkpost-row-${wid}-${tid}`).show();
				$(`.sendgrid-row-${wid}-${tid}, .aws-row-${wid}-${tid}, .gmail-row-${wid}-${tid}`).hide();
			} else{
				$(`.sparkpost-row-${wid}-${tid}, .sendgrid-row-${wid}-${tid}, .aws-row-${wid}-${tid}, .gmail-row-${wid}-${tid}`).hide();
			}
		})
		
		
		$(`.restore-${wid}-${tid}`).on('click', function(e) {
			console.log("Restore called")
			if (!task) return;
			var pj = task;
			// Page Setup
			// Print
			if (pj.print.type === "workbook") {
				$(`#print-${wid}-${tid}`).val(pj.print.type).trigger("change");
				
				$(`.selection-${wid}-${tid} :checkbox`).prop('checked', false); //deselect all
				$(`.selection-${wid}-${tid} :checkbox`).each(function() {
					pj.print.value.forEach((val) => {
						if (val.sheet === $(this).val()) {
							$(this).prop('checked', true).trigger("change");
						}
					})
				}).trigger("change");
			} else if (pj.print.type === "custom") {
				if(pj.print.value[0].hasOwnProperty("range"))
				{
					optionText = `Selected range of ${ pj.print.value[0].sheet}`;
					$(`#print-range-${wid}-${tid}`).val(pj.print.value[0].range)
				}
				else
					optionText = `${ pj.print.value[0].sheet}`

				$(`#print-${wid}-${tid} option`).removeAttr('selected').map(function() {
					if ($(this).text() === optionText) return this;
				}).attr('selected', true).trigger("change");
			}

			// Paper size
			if (pj.size.type === "custom") {
				$(`#size-${wid}-${tid}`).val(pj.size.type).trigger("change");
				$(`#size-height-${wid}-${tid}`).val(pj.size.value.height);
				$(`#size-width-${wid}-${tid}`).val(pj.size.value.width);
			} else {
				$(`#size-${wid}-${tid}`).val(pj.size.type).trigger("change");
			}
			// Margins
			if (pj.margins.type === "custom") {
				$(`#margins-${wid}-${tid}`).val(pj.margins.type).trigger("change");
				$(`#margins-top-${wid}-${tid}`).val(pj.margins.value.top);
				$(`#margins-left-${wid}-${tid}`).val(pj.margins.value.left);
				$(`#margins-right-${wid}-${tid}`).val(pj.margins.value.right);
				$(`#margins-bottom-${wid}-${tid}`).val(pj.margins.value.bottom);
			} else {
				$(`#margins-${wid}-${tid}`).val(pj.margins.type).trigger("change");
			}
			// Scale
			
			
			if (pj.scale.type === "custom") {
				$(`#scale-${wid}-${tid}`).val(pj.scale.type).trigger("change");
				$(`#percentage-${wid}-${tid}`).val(pj.scale.value.percentage * 100);
			} else if (pj.scale.type == "fit_pagebreak") {
			
			console.log("calling " + pj.scale.type);
			
				$(`#scale-${wid}-${tid}`).val(pj.scale.type).trigger("change");
				$(`#break-row-${wid}-${tid}`).val(pj.scale.value.row)
				$(`#break-column-${wid}-${tid}`).val(pj.scale.value.column).trigger("change");
			} else {
				$(`#scale-${wid}-${tid}`).val(pj.scale.type).trigger("change");
			}
			
			
			// Set page orientation
			$("input[name='pageSetupRadio']").val([`${pj.orientation.type}`])
			// Formatting Tab
			$(`#pageorder-${wid}-${tid}`).val(pj.pageorder.value).trigger("change");
			$(`#horizontal-alignment-${wid}-${tid}`).val(pj.h_alignment.value).trigger("change");
			$(`#vertical-alignment-${wid}-${tid}`).val(pj.v_alignment.value).trigger("change");
			if (pj.notes.value === "true") {
				$(`#shownotes-${wid}-${tid}`).prop('checked', true);
			}
			if (pj.gridlines.value === "true") {
				$(`#showgridlines-${wid}-${tid}`).prop('checked', true);
			}
			// Headers and Footers tab
			if (pj.hf.options.hf_fzr) {
				$(`#frozen-rows-${wid}-${tid}`).prop('checked', true);
			}
			if (pj.hf.options.hf_fzc) {
				$(`#frozen-columns-${wid}-${tid}`).prop('checked', true);
			}
			$(`#top-left-${wid}-${tid}`).val(pj.hf.value.top_left)
			$(`#top-middle-${wid}-${tid}`).val(pj.hf.value.top_center)
			$(`#top-right-${wid}-${tid}`).val(pj.hf.value.top_right)
			$(`#bottom-left-${wid}-${tid}`).val(pj.hf.value.bottom_left)
			$(`#bottom-middle-${wid}-${tid}`).val(pj.hf.value.bottom_center)
			$(`#bottom-right-${wid}-${tid}`).val(pj.hf.value.bottom_right)
		}).trigger("click");
		
		
		$(`.done-${wid}-${tid}`).on('click', function(e) {
			e.preventDefault()
			e.stopPropagation()
			console.log(JSON.stringify(getPDFFileValues(wid, tid), null, 4));
			// if (getPDFFileValues(wid, tid)) {
			// $(`#task-modal-${wid}-${tid}`).modal('hide');
			// }
		})
	}
	// Delete Instance
	$(`.tdelete`).on('click', function(e) {
		$(this).parent().parent().parent().parent().remove();
	})
	$("#pdfprint").click(function(event) {
		createTask_PDFFile("l9zgqjql")
	});
	$("#restoreall").click(function(event) {
		$("#tasks-point-l9zgqjql").html('')
		var wflw = {
			id: "l9zgqjql",
			tasks: [{
				"taskType": "pdfprint",
				"id": "y9f514dg",
				"name": "l9zgqjql-y9f514dg",
				"print": {
					"type": "custom",
					"value": [{
						"sheet": "Sheet1",
						"range": "A2:A"
					}]
				},
				"size": {
					"type": "letter"
				},
				"scale": {
					"type": "custom",
					"value": {
						"percentage": "0.78"
					}
				},
				"margins": {
					"type": "normal"
				},
				"orientation": {
					"type": "landscape"
				},
				"gridlines": {
					"value": true
				},
				"notes": {
					"value": true
				},
				"pageorder": {
					"value": "down_then_over"
				},
				"h_alignment": {
					"value": "horizontal_left"
				},
				"v_alignment": {
					"value": "vertical_center"
				},
				"hf": {
					"options": {
						"hf_fzr": true,
						"hf_fzc": true
					},
					"type": "custom",
					"value": {
						"top_left": "Top Left",
						"top_center": "Top Middle",
						"top_right": "Top Right",
						"bottom_left": "Bottom Left",
						"bottom_center": "Bottom Middle",
						"bottom_right": "Bottom Right"
					}
				}
			}, {
				"taskType": "pdfprint",
				"id": "j2f514dg",
				"name": "l9zgqjql-j2f514dg",
				"print": {
					"type": "workbook",
					"value": [{
						"sheet": "Sheet2"
					}]
				},
				"size": {
					"type": "custom",
					"value": {
						"height": "20",
						"width": "20"
					}
				},
				"scale": {
					"type": "fit_pagebreak",
					"value": {
						"row": "29",
						"column": "7"
					}
				},
				"margins": {
					"type": "custom",
					"value": {
						"top": "1",
						"left": "1",
						"right": "1",
						"bottom": "1"
					}
				},
				"orientation": {
					"type": "protait"
				},
				"gridlines": {
					"value": true
				},
				"notes": {
					"value": true
				},
				"pageorder": {
					"value": "down_then_over"
				},
				"h_alignment": {
					"value": "horizontal_left"
				},
				"v_alignment": {
					"value": "vertical_center"
				},
				"hf": {
					"options": {
						"hf_fzr": true,
						"hf_fzc": true
					},
					"type": "custom",
					"value": {
						"top_left": "Top Left",
						"top_center": "Top Middle",
						"top_right": "Top Right",
						"bottom_left": "Bottom Left",
						"bottom_center": "Bottom Middle",
						"bottom_right": "Bottom Right"
					}
				}
			}]
		}
		wflw.tasks.forEach(t => {
			if (t.taskType == "pdfprint") {
				createTask_PDFFile(wflw.id, t)
			}
		})
	});
	$(`#sendall`).click(function(e) {
		r = [];
		error = false;
		$(`#tasks-point-l9zgqjql`).children().each(function() {
			if ($(this).data("type") == "pdfprint") {
				var ids = $(this).data("id").split("-");
				var w = getPDFFileValues(ids[0], ids[1])
				if (!w) {
					$(`#task-modal-${$(this).data("id")}`).modal("show");
					error = true;
					return false;
				} else r.push(w);
			}
		});
		if (!error) console.log(JSON.stringify(r, null, 4))
	});
	</script>
</body>

</html>
